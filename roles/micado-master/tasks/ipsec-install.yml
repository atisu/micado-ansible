---
# install strongSwan
- name: Install strongSwan
  apt:
    name: strongswan
    state: present

# create configuration
- name: "Create ipsec configuration"
  copy:
    content: |
        conn iptunnel
                type=transport
                compress=no
                keyexchange=ikev2
                authby=pubkey
                leftcert=172.31.32.13
                left={{ ansible_default_ipv4.address }}
                right=%any
                auto=start
    dest: /etc/ipsec.conf

# start and enable strongSwan
- name: 'Enable/Start strongSwan'
  service:
    name: strongSwan
    state: started
    enabled: yes
